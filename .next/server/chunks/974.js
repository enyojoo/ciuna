"use strict";exports.id=974,exports.ids=[974],exports.modules={6974:(e,r,t)=>{t.d(r,{yD:()=>s,OQ:()=>i});var n=t(7729);let a=process.env.NEXT_PUBLIC_SUPABASE_URL||process.env.SUPABASE_URL||"http://localhost:54321",o=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||process.env.SUPABASE_ANON_KEY||"your-anon-key",l=process.env.SUPABASE_SERVICE_ROLE_KEY||"your-service-role-key",i=(0,n.eI)(a,o,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});(0,n.eI)(a,l,{auth:{autoRefreshToken:!1,persistSession:!1}});class s{static async trackEvent(e){try{let{data:r,error:t}=await i.rpc("track_event",{p_user_id:e.user_id||null,p_session_id:e.session_id||null,p_event_type:e.event_type,p_event_category:e.event_category,p_event_action:e.event_action,p_event_label:e.event_label||null,p_event_value:e.event_value||null,p_properties:e.properties||{},p_page_url:e.page_url||null,p_referrer:e.referrer||null,p_user_agent:e.user_agent||null,p_ip_address:e.ip_address||null,p_country_code:e.country_code||null,p_city:e.city||null,p_device_type:e.device_type||null,p_browser:e.browser||null,p_os:e.os||null});if(t)return console.error("Error tracking event:",t),null;return r}catch(e){return console.error("Error in trackEvent:",e),null}}static async trackConversion(e){try{let{data:r,error:t}=await i.rpc("track_conversion",{p_user_id:e.user_id||null,p_session_id:e.session_id||null,p_conversion_type:e.conversion_type,p_conversion_value:e.conversion_value||null,p_currency_code:e.currency_code||"RUB",p_item_id:e.item_id||null,p_item_type:e.item_type||null,p_properties:e.properties||{}});if(t)return console.error("Error tracking conversion:",t),null;return r}catch(e){return console.error("Error in trackConversion:",e),null}}static async trackPageView(e){try{let{data:r,error:t}=await i.from("page_views").insert({user_id:e.user_id||null,session_id:e.session_id||null,page_path:e.page_path,page_title:e.page_title||null,page_category:e.page_category||null,referrer:e.referrer||null,utm_source:e.utm_source||null,utm_medium:e.utm_medium||null,utm_campaign:e.utm_campaign||null,utm_term:e.utm_term||null,utm_content:e.utm_content||null,duration_seconds:e.duration_seconds||null,scroll_depth:e.scroll_depth||null,exit_page:e.exit_page||!1}).select("id").single();if(t)return console.error("Error tracking page view:",t),null;return r.id}catch(e){return console.error("Error in trackPageView:",e),null}}static async trackPerformance(e){try{let{data:r,error:t}=await i.from("performance_metrics").insert({page_path:e.page_path||null,load_time_ms:e.load_time_ms||null,first_contentful_paint_ms:e.first_contentful_paint_ms||null,largest_contentful_paint_ms:e.largest_contentful_paint_ms||null,first_input_delay_ms:e.first_input_delay_ms||null,cumulative_layout_shift:e.cumulative_layout_shift||null,time_to_interactive_ms:e.time_to_interactive_ms||null,user_id:e.user_id||null,session_id:e.session_id||null,device_type:e.device_type||null,browser:e.browser||null}).select("id").single();if(t)return console.error("Error tracking performance metric:",t),null;return r.id}catch(e){return console.error("Error in trackPerformance:",e),null}}static async trackError(e){try{let{data:r,error:t}=await i.from("error_events").insert({user_id:e.user_id||null,session_id:e.session_id||null,error_type:e.error_type,error_message:e.error_message,error_stack:e.error_stack||null,page_url:e.page_url||null,user_agent:e.user_agent||null,properties:e.properties||{}}).select("id").single();if(t)return console.error("Error tracking error event:",t),null;return r.id}catch(e){return console.error("Error in trackError:",e),null}}static async getDashboardData(e,r){try{let{data:t,error:n}=await i.rpc("get_analytics_dashboard_data",{p_start_date:e.toISOString(),p_end_date:r.toISOString()});if(n)return console.error("Error getting dashboard data:",n),null;return t}catch(e){return console.error("Error in getDashboardData:",e),null}}static async getUserAnalytics(e,r,t){try{let n=i.from("analytics_events").select("*").eq("user_id",e).order("created_at",{ascending:!1});r&&(n=n.gte("created_at",r.toISOString())),t&&(n=n.lte("created_at",t.toISOString()));let{data:a,error:o}=await n;if(o)return console.error("Error getting user analytics:",o),null;return a}catch(e){return console.error("Error in getUserAnalytics:",e),null}}static async getConversionFunnel(e,r){try{let{data:t,error:n}=await i.from("conversion_events").select("conversion_type, created_at").gte("created_at",e.toISOString()).lte("created_at",r.toISOString()).order("created_at",{ascending:!0});if(n)return console.error("Error getting conversion funnel:",n),null;return t.reduce((e,r)=>{let t=new Date(r.created_at).toDateString();return e[t]||(e[t]={}),e[t][r.conversion_type]||(e[t][r.conversion_type]=0),e[t][r.conversion_type]++,e},{})}catch(e){return console.error("Error in getConversionFunnel:",e),null}}static async getRealTimeMetrics(){try{let e=new Date,r=new Date(e.getTime()-36e5),{data:t,error:n}=await i.rpc("get_analytics_dashboard_data",{p_start_date:r.toISOString(),p_end_date:e.toISOString()});if(n)return console.error("Error getting real-time metrics:",n),null;return t}catch(e){return console.error("Error in getRealTimeMetrics:",e),null}}}class c{static async getLanguages(){if(this.languagesCache)return this.languagesCache;try{let{data:e,error:r}=await i.from("languages").select("*").eq("is_active",!0).order("name");if(r)return console.error("Error fetching languages:",r),[];return this.languagesCache=e||[],this.languagesCache}catch(e){return console.error("Error in getLanguages:",e),[]}}static async getTranslations(e,r="common"){let t=`${e}:${r}`;if(this.translationsCache.has(t))return this.translationsCache.get(t);try{let{data:n,error:a}=await i.from("translations").select("key, value").eq("language_code",e).eq("namespace",r);if(a)return console.error("Error fetching translations:",a),new Map;let o=new Map;return(n||[]).forEach(e=>{o.set(e.key,e.value)}),this.translationsCache.set(t,o),o}catch(e){return console.error("Error in getTranslations:",e),new Map}}static async getTranslation(e,r="en",t="common"){try{let{data:n,error:a}=await i.rpc("get_translation",{p_key:e,p_language_code:r,p_namespace:t});if(a)return console.error("Error getting translation:",a),e;return n||e}catch(r){return console.error("Error in getTranslation:",r),e}}static async getLocalizedContent(e,r,t="en",n){try{let{data:a,error:o}=await i.rpc("get_localized_content",{p_content_type:e,p_content_id:r,p_language_code:t,p_field_name:n});if(o)return console.error("Error getting localized content:",o),null;return a}catch(e){return console.error("Error in getLocalizedContent:",e),null}}static async setLocalizedContent(e,r,t,n,a){try{let{data:o,error:l}=await i.rpc("set_localized_content",{p_content_type:e,p_content_id:r,p_language_code:t,p_field_name:n,p_field_value:a});if(l)return console.error("Error setting localized content:",l),null;return o}catch(e){return console.error("Error in setLocalizedContent:",e),null}}static async getUserPreferences(e){try{let{data:r,error:t}=await i.from("profiles").select("preferred_language, timezone, date_format, time_format, currency_code").eq("id",e).single();if(t)return console.error("Error getting user preferences:",t),null;return{preferred_language:r.preferred_language||"en",timezone:r.timezone||"UTC",date_format:r.date_format||"MM/DD/YYYY",time_format:r.time_format||"12h",currency_code:r.currency_code||"RUB"}}catch(e){return console.error("Error in getUserPreferences:",e),null}}static async updateUserPreferences(e,r){try{let{error:t}=await i.from("profiles").update({preferred_language:r.preferred_language,timezone:r.timezone,date_format:r.date_format,time_format:r.time_format,currency_code:r.currency_code,updated_at:new Date().toISOString()}).eq("id",e);if(t)return console.error("Error updating user preferences:",t),!1;return!0}catch(e){return console.error("Error in updateUserPreferences:",e),!1}}static clearCache(){this.translationsCache.clear(),this.languagesCache=[]}static formatDate(e,r="en",t="UTC"){let n="string"==typeof e?new Date(e):e;try{return new Intl.DateTimeFormat(r,{timeZone:t,year:"numeric",month:"long",day:"numeric"}).format(n)}catch(e){return console.error("Error formatting date:",e),n.toLocaleDateString()}}static formatTime(e,r="en",t="UTC",n="12h"){let a="string"==typeof e?new Date(e):e;try{return new Intl.DateTimeFormat(r,{timeZone:t,hour:"numeric",minute:"2-digit",hour12:"12h"===n}).format(a)}catch(e){return console.error("Error formatting time:",e),a.toLocaleTimeString()}}static formatCurrency(e,r="RUB",t="en"){try{return new Intl.NumberFormat(t,{style:"currency",currency:r}).format(e)}catch(t){return console.error("Error formatting currency:",t),`${e} ${r}`}}static formatNumber(e,r="en",t){try{return new Intl.NumberFormat(r,t).format(e)}catch(r){return console.error("Error formatting number:",r),e.toString()}}static formatRelativeTime(e,r="en",t="UTC"){let n="string"==typeof e?new Date(e):e,a=Math.floor((new Date().getTime()-n.getTime())/1e3);try{let e=new Intl.RelativeTimeFormat(r,{numeric:"auto"});if(a<60)return e.format(-a,"second");if(a<3600)return e.format(-Math.floor(a/60),"minute");if(a<86400)return e.format(-Math.floor(a/3600),"hour");if(a<2592e3)return e.format(-Math.floor(a/86400),"day");else if(a<31536e3)return e.format(-Math.floor(a/2592e3),"month");else return e.format(-Math.floor(a/31536e3),"year")}catch(e){return console.error("Error formatting relative time:",e),n.toLocaleDateString()}}}c.translationsCache=new Map,c.languagesCache=[]}};