(()=>{var e={};e.id=381,e.ids=[381],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},2675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>o}),r(2229),r(9642),r(2865);var s=r(9727),i=r(4975),l=r(4368),a=r.n(l),c=r(4421),n={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>c[e]);r.d(t,n);let o=["",{children:["sell",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2229)),"D:\\Users\\enyoc\\Documents\\Dev\\ciuna\\app\\sell\\new\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,9642)),"D:\\Users\\enyoc\\Documents\\Dev\\ciuna\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,2865,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\Users\\enyoc\\Documents\\Dev\\ciuna\\app\\sell\\new\\page.tsx"],u="/sell/new/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/sell/new/page",pathname:"/sell/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},7302:(e,t,r)=>{Promise.resolve().then(r.bind(r,8792))},8792:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(3380),i=r(9879),l=r(6293),a=r(443),c=r(3796),n=r(7093);let o=(0,r(7603).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var d=r(130),u=r(3019),m=r(4442);function x(){let{user:e,profile:t}=(0,u.a)(),r=(0,l.useRouter)(),[x,p]=(0,i.useState)(!1),[h,g]=(0,i.useState)([]),[b,y]=(0,i.useState)({title:"",description:"",category_id:"",price_rub:"",condition:"GOOD",city:"",district:"",photo_urls:[]}),[j,f]=(0,i.useState)({}),v=e=>{let{name:t,value:r}=e.target;y(e=>({...e,[t]:r})),j[t]&&f(e=>({...e,[t]:""}))},N=e=>{y(t=>({...t,photo_urls:t.photo_urls.filter((t,r)=>r!==e)}))},_=()=>{let e={};return b.title.trim()||(e.title="Title is required"),b.description.trim()||(e.description="Description is required"),b.category_id||(e.category_id="Category is required"),(!b.price_rub||isNaN(Number(b.price_rub))||0>=Number(b.price_rub))&&(e.price_rub="Valid price is required"),b.city.trim()||(e.city="City is required"),f(e),0===Object.keys(e).length},w=async t=>{if(t.preventDefault(),_()){p(!0);try{let t={...b,price_rub:parseInt(b.price_rub),category_id:b.category_id,seller_id:e?.id||"",status:"ACTIVE",currency:"RUB",is_negotiable:!0,tags:[]},s=await m.db.listings.create(t);r.push(`/listings/${s.id}`)}catch(e){console.error("Error creating listing:",e),f({submit:"Failed to create listing. Please try again."})}finally{p(!1)}}};return e?(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[(0,s.jsxs)("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Create New Listing"}),s.jsx("p",{className:"text-lg text-gray-600",children:"Sell your items to fellow expats in Russia"})]}),(0,s.jsxs)(a.Zb,{children:[s.jsx(a.Ol,{children:s.jsx(a.ll,{children:"Listing Details"})}),s.jsx(a.aY,{children:(0,s.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[j.submit&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-md text-sm",children:j.submit}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),s.jsx(a.II,{id:"title",name:"title",value:b.title,onChange:v,placeholder:"What are you selling?",className:j.title?"border-red-300":""}),j.title&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.title})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),s.jsx("textarea",{id:"description",name:"description",value:b.description,onChange:v,rows:4,placeholder:"Describe your item in detail...",className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${j.description?"border-red-300":""}`}),j.description&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.description})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"category_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),(0,s.jsxs)("select",{id:"category_id",name:"category_id",value:b.category_id,onChange:v,className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${j.category_id?"border-red-300":""}`,children:[s.jsx("option",{value:"",children:"Select a category"}),h.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),j.category_id&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.category_id})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"condition",className:"block text-sm font-medium text-gray-700 mb-2",children:"Condition"}),s.jsx("select",{id:"condition",name:"condition",value:b.condition,onChange:v,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[{value:"NEW",label:"New"},{value:"LIKE_NEW",label:"Like New"},{value:"GOOD",label:"Good"},{value:"FAIR",label:"Fair"}].map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"price_rub",className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (RUB) *"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx(c.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),s.jsx(a.II,{id:"price_rub",name:"price_rub",type:"number",value:b.price_rub,onChange:v,placeholder:"0",className:`pl-10 ${j.price_rub?"border-red-300":""}`})]}),j.price_rub&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.price_rub})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),s.jsx(a.II,{id:"city",name:"city",value:b.city,onChange:v,placeholder:"Moscow, St. Petersburg, etc.",className:`pl-10 ${j.city?"border-red-300":""}`})]}),j.city&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:j.city})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{htmlFor:"district",className:"block text-sm font-medium text-gray-700 mb-2",children:"District (Optional)"}),s.jsx(a.II,{id:"district",name:"district",value:b.district,onChange:v,placeholder:"Arbat, Nevsky Prospekt, etc."})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Photos"}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-center w-full",children:(0,s.jsxs)("label",{htmlFor:"photos",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[s.jsx(o,{className:"w-8 h-8 mb-4 text-gray-500"}),(0,s.jsxs)("p",{className:"mb-2 text-sm text-gray-500",children:[s.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG up to 10MB each"})]}),s.jsx("input",{id:"photos",type:"file",multiple:!0,accept:"image/*",onChange:e=>{let t=e.target.files;if(t){let e=Array.from(t).map(e=>URL.createObjectURL(e));y(t=>({...t,photo_urls:[...t.photo_urls,...e]}))}},className:"hidden"})]})}),b.photo_urls.length>0&&s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:b.photo_urls.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[s.jsx("img",{src:e,alt:`Upload ${t+1}`,className:"w-full h-24 object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>N(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:s.jsx(d.Z,{className:"h-4 w-4"})})]},t))})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[s.jsx(a.zx,{type:"button",variant:"outline",onClick:()=>r.back(),children:"Cancel"}),s.jsx(a.zx,{type:"submit",disabled:x,children:x?"Creating...":"Create Listing"})]})]})})]})]}):null}},7093:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(7603).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2229:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(967).createProxy)(String.raw`D:\Users\enyoc\Documents\Dev\ciuna\app\sell\new\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[843,191,448],()=>r(2675));module.exports=s})();